include_directories(${CMAKE_SOURCE_DIR}/blackbox)
include_directories(${CMAKE_SOURCE_DIR}/bblib)
#include_directories(${CMAKE_SOURCE_DIR}/plugins/bbPlugin)

# bbproto + asn1
add_definitions("-DASSUMESTDTYPES") # asn1: use types from cstdint 
add_definitions("-DUSE_CXX_ALLOCATOR")
add_definitions("-D_CRT_SECURE_NO_WARNINGS") # msvc shut up pls
include_directories(${CMAKE_BINARY_DIR}/bbproto)
file(GLOB files "${CMAKE_BINARY_DIR}/bbproto/*.c") # these files are generated by asn1c from trace_proto.asn1 
set_source_files_properties(${files} PROPERTIES LANGUAGE CXX) 
# asio
add_definitions("-DASIO_STANDALONE")
include_directories (${CMAKE_SOURCE_DIR}/3rd_party/asio/include)

### taskhook
add_library(taskhook SHARED taskhook.cpp ${files})
target_link_libraries(taskhook bblib bbproto)
target_link_libraries(taskhook version comctl32)
set_property(TARGET taskhook PROPERTY FOLDER "bbTT/hooks/taskhook")
install(TARGETS taskhook RUNTIME DESTINATION .)
if(MSVC)
	install(FILES ${CMAKE_CURRENT_BINARY_DIR}/Debug/taskhook.pdb DESTINATION .	CONFIGURATIONS Debug)
endif(MSVC)

### trayhook
add_library(trayhook SHARED trayhook.cpp)
target_link_libraries(trayhook bblib)
target_link_libraries(trayhook version comctl32)
set_property(TARGET trayhook PROPERTY FOLDER "bbTT/hooks/trayhook")
install(TARGETS trayhook RUNTIME DESTINATION .)
if(MSVC)
	install(FILES ${CMAKE_CURRENT_BINARY_DIR}/Debug/trayhook.pdb DESTINATION .	CONFIGURATIONS Debug)
endif(MSVC)


